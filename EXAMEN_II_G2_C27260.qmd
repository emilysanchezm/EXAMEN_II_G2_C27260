---
title: "Tarea3_CA0204_C27260"
author: "Emily Sánchez"
subtitle: "CA0204 - Herramientas de Ciencia de Datos I"
institute: "Universidad de Costa Rica"
titlepage: false
editor: visual
format:
  html:
    self-contained: true
    embed-resources: true
---

# 1

```{r}
# Carga de paquetes
library(tidyverse)
library(readr)

# carga de txt a r 
moras <- read_csv("~/Downloads/moras.txt", 
                  col_types =  cols(SALARIO = col_character()))

moras$SALARIO <- gsub(",", ".", moras$SALARIO)


```


# 2

```{r}
# Se agregan un resumen de los 5 números por variable cuantitativa
summary(moras$IDENTIFICACION)

summary(moras$EDAD)

moras$SALARIO <- as.numeric(moras$SALARIO)
summary(moras$SALARIO)

```

# 3

```{r}
library(dplyr)

moras <- moras %>% 
  mutate(
    # Se calcula Z-score para SALARIO y se determinan los valores atípicos.
    # Se usa la formula de Z-score para la media y desviación se omiten los NAs. Note que si el valor era NA se mantendrá como NA.
    ZSCORE_SALARIO = (SALARIO - mean(SALARIO, na.rm = TRUE)) / sd(SALARIO, na.rm = TRUE),
    
    # Se compara con 1.96 los NA siempre quedan como NAs 
    ATIPICO_SALARIO = abs(ZSCORE_SALARIO) > 1.96,
    
    # Análogo a lo de arriba.
    ZSCORE_EDAD = (EDAD - mean(EDAD, na.rm = TRUE)) / sd(EDAD, na.rm = TRUE),
    ATIPICO_EDAD = abs(ZSCORE_EDAD) > 1.96
  )

```

# 4

```{r}
# Se saca el porcentaje de NAs por variable/ columna.
# Se cuentan los NAs por columna, se dividen entre el número total de observaciones y se multiplica por 100 para obtener un porcentaje.
porcentaje_na <- colSums(is.na(moras)) / nrow(moras) * 100
porcentaje_na

```

# 5 
```{r}
# Imputamos las numéricas por el promedio. 
moras$SALARIO <- ifelse(is.na(moras$SALARIO), # Condición lógica
                        mean(moras$SALARIO, na.rm = TRUE), # Si se cumple
                        moras$SALARIO) # Si no se cumple

moras$EDAD <- ifelse(is.na(moras$EDAD), 
                     mean(moras$EDAD, na.rm = TRUE), 
                     moras$EDAD)


# Se crea un función para encontrar la moda de la variable categórica.
moda <- function(x) {
  tab <- table(x)           # Se crea una tabla de frecuencias de cada tipo de aseguramiento.
  names(tab)[which.max(tab)]  # which.max() devuelve la posición del valor máximo en un vector y names (tab) devuelve los nombres de cada elemento de tab. Combinado, esta linea toma los nombres de tab y selecciona el que corresponde a la posición de la frecuencia máxima.
}

# Se imputa con la moda 
moras$TIPO_ASEGURAMIENTO[is.na(moras$TIPO_ASEGURAMIENTO)] <- moda(moras$TIPO_ASEGURAMIENTO)

```





